-- S03b-- create inventory updates.sql
-- Updates the inventory table for version b: adds default values for image/thumbnail, price constraints, and year range check.
-- Ensures all required fields, constraints, and foreign key relationships are present for assignment 4 requirements.

-- Table structure for table 'inventory' (version b, self-contained)
CREATE TABLE IF NOT EXISTS PUBLIC.inventory (
	inv_id INTEGER NOT NULL GENERATED BY DEFAULT AS IDENTITY,
	inv_vin CHARACTER VARYING NOT NULL UNIQUE,
	inv_make CHARACTER VARYING NOT NULL,
	inv_model CHARACTER VARYING NOT NULL,
	inv_year CHARACTER(4) NOT NULL,
	inv_description TEXT,
	inv_image CHARACTER VARYING DEFAULT 'No Image Available',
	inv_thumbnail CHARACTER VARYING DEFAULT 'No Image Available',
	inv_price NUMERIC(9,0) DEFAULT 0,
	inv_miles INTEGER,
	inv_color CHARACTER VARYING,
	classification_id INTEGER NOT NULL,
	CONSTRAINT inventory_pk PRIMARY KEY (inv_id),
	CONSTRAINT inventory_price_nonnegative CHECK (inv_price >= 0),
	CONSTRAINT inventory_year_valid CHECK (inv_year::integer >= 1900 AND inv_year::integer <= 2100)
);
ALTER TABLE IF EXISTS PUBLIC.inventory
	ADD CONSTRAINT fk_classification FOREIGN KEY (classification_id)
	REFERENCES PUBLIC.classification (classification_id) MATCH SIMPLE
	ON UPDATE CASCADE
	ON DELETE NO ACTION;
